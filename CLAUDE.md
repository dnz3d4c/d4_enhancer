<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>

# D4GameEnhancer

디아블로 IV를 NVDA 스크린 리더로 플레이할 수 있게 해주는 NVDA 추가 기능.

## 프로젝트 정보

| 항목 | 내용 |
|------|------|
| 유형 | NVDA globalPlugin |
| 대상 게임 | Diablo IV |
| 최소 NVDA | 2023.1 |

## 현재 기능

- TTS 후킹: 게임 텍스트를 NVDA로 전달
- 규칙 엔진: 빈 문자열/공백 필터링 (rules/d4_rules.json)
- 로깅 토글: NVDA+ALT+D (애드온 루트에 D4GameEnhancer.log 생성)

## 기술 스택

- Python 3.x (NVDA 내장 인터프리터)
- NVDA API: api, globalPluginHandler, speech, NVDAHelper, queueHandler
- 외부 의존성 없음

## API 문서

NVDA 추가 기능 개발 참조: `C:/project/NVDAAddons/docs/NVDA_API_Reference.md`

## 디렉토리 구조

```
globalPlugins/
├── d4_game_enhancer.py   # 메인 플러그인
├── d4_rule_engine.py     # 규칙 엔진
└── rules/
    └── d4_rules.json     # 필터링 규칙
scripts/build.py          # 빌드 스크립트
manifest.ini              # 추가 기능 메타데이터
dist/                     # 빌드 출력
```

## 빌드

```bash
uv run python scripts/build.py
# 결과: dist/D4GameEnhancer-vX.X.X.nvda-addon
```

## 테스트

1. NVDA 설정 > 개발자 옵션에서 scratchpad 활성화
2. `globalPlugins/` 폴더를 NVDA scratchpad에 복사
3. NVDA 재시작 후 디아블로 IV 실행
4. NVDA+ALT+D로 로깅 토글 확인

## 에이전트 사용

| 작업 | 에이전트 |
|------|----------|
| 플러그인 구현 | @vibe-coder |
| 스크린 리더 호환성 | @a11y-expert |
| 사용자 매뉴얼 | @doc-writer |

## 코딩 규칙

- NVDA 코딩 컨벤션 준수
- 단축키: NVDA+ALT 조합 사용 (게임 키와 충돌 방지)
- 새 기능마다 토글/디버그 로깅 포함
- 슬립 모드 체크 필수 (SLEEP_FULL 상태면 TTS 무시)

## 주의사항

- NVDAHelper DLL 함수 포인터 조작 시 원본 백업 필수
- 게임 텍스트 파싱 로직은 게임 업데이트로 깨질 수 있음
- 로그 파일 크기 관리 필요 (장시간 플레이 시)
